<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>YT Thumbnail Grabber</title>
  <style>
    :root{--bg:#0f172a;--card:#111827;--muted:#94a3b8;--accent:#22d3ee;--ring:#22d3ee33;--btn:#1f2937;--ok:#22c55e;--err:#ef4444}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:radial-gradient(1200px 600px at 100% -20%,#0b1220,transparent),radial-gradient(1000px 800px at -20% 120%,#091225,transparent),var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica,Arial,sans-serif;color:#e5e7eb}
    .wrap{min-height:100%;display:grid;place-items:center;padding:24px}
    .app{width:100%;max-width:860px;background:linear-gradient(180deg,#0b1220 0%,#0a0f1a 100%);border:1px solid #1f2937;border-radius:22px;box-shadow:0 20px 60px #0008, inset 0 0 0 1px #000;overflow:hidden}
    .bar{display:flex;gap:12px;padding:18px;border-bottom:1px solid #1f2937;background:linear-gradient(180deg,#0b1220,#0c1526)}
    .field{position:relative;flex:1}
    input[type="url"]{width:100%;padding:14px 46px 14px 44px;border-radius:14px;border:1px solid #243041;background:#0a0f1a;color:#e5e7eb;outline:none}
    input[type="url"]:focus{border-color:var(--accent);box-shadow:0 0 0 6px var(--ring)}
    .ytbadge{position:absolute;left:12px;top:50%;transform:translateY(-50%);pointer-events:none;opacity:.8}
    .clear{position:absolute;right:8px;top:50%;transform:translateY(-50%);background:transparent;border:0;color:#94a3b8;cursor:pointer;font-size:18px}
    .btn{appearance:none;border:1px solid #243041;background:linear-gradient(180deg,#0e1526,#0a0f1a);color:#e5e7eb;border-radius:12px;padding:12px 14px;cursor:pointer}
    .btn:focus{outline:none;box-shadow:0 0 0 6px var(--ring)}
    .btn[disabled]{opacity:.5;cursor:not-allowed}
    .grid{display:grid;gap:16px;padding:18px}
    .preview{position:relative;border-radius:16px;overflow:hidden;border:1px solid #263244;background:#0a0f1a;min-height:220px;display:grid;place-items:center}
    .preview img{width:100%;height:auto;display:block}
    .hint{position:absolute;inset:auto 12px 12px auto;background:#0a0f1a99;border:1px solid #243041;border-radius:999px;padding:8px 12px;font-size:12px;color:var(--muted)}
    .dlFab{position:absolute;bottom:14px;left:14px;background:linear-gradient(180deg,#16a34a,#15803d);border:0;border-radius:999px;padding:10px 14px;display:flex;align-items:center;gap:8px;color:#eafff3;font-weight:600;cursor:pointer;box-shadow:0 6px 20px #16a34a60}
    .dlFab svg{filter:drop-shadow(0 2px 6px #0008)}
    .sizes{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px}
    .size a{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:12px 14px;border-radius:12px;border:1px solid #263244;background:#0a0f1a;text-decoration:none;color:#e5e7eb}
    .size small{color:var(--muted)}
    .msg{padding:14px 16px;border-radius:12px;border:1px solid #243041;background:#0b1220;color:#cbd5e1}
    .ok{border-color:#14532d}
    .err{border-color:#4c1d1d}
    .footer{padding:10px 18px;border-top:1px dashed #213}
    .hide{display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="app" role="application">
      <div class="bar">
        <div class="field">
          <svg class="ytbadge" width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M23.5 6.2a4 4 0 0 0-2.8-2.9C18.9 2.6 12 2.6 12 2.6s-6.9 0-8.7.7A4 4 0 0 0 .5 6.2 41.3 41.3 0 0 0 0 12a41.3 41.3 0 0 0 .5 5.8 4 4 0 0 0 2.8 2.9c1.8.7 8.7.7 8.7.7s6.9 0 8.7-.7a4 4 0 0 0 2.8-2.9A41.3 41.3 0 0 0 24 12a41.3 41.3 0 0 0-.5-5.8ZM9.6 15.5V8.4l6.4 3.5-6.4 3.6Z"/></svg>
          <input id="url" type="url" inputmode="url" placeholder="Paste YouTube link…" autocomplete="off" spellcheck="false" />
          <button class="clear" title="Clear" aria-label="Clear" onclick="resetAll()">×</button>
        </div>
        <button id="pasteBtn" class="btn" title="Paste">Paste</button>
      </div>

      <div class="grid">
        <div id="status" class="msg" aria-live="polite">Paste a YouTube link.</div>

        <div class="preview" id="preview" aria-busy="true">
          <div id="ph" class="hint">Thumbnail preview</div>
          <img id="thumb" alt="" class="hide" />
          <button id="dlFab" class="dlFab hide" title="Download max quality" onclick="downloadBest()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            Download
          </button>
        </div>

        <div class="sizes" id="sizes" aria-label="Sizes"></div>
      </div>

      <div class="footer">
        <!-- intentional minimal footer, no disclaimers -->
      </div>
    </div>
  </div>

  <script>
    const urlEl = document.getElementById('url');
    const statusEl = document.getElementById('status');
    const preview = document.getElementById('preview');
    const thumb = document.getElementById('thumb');
    const ph = document.getElementById('ph');
    const sizes = document.getElementById('sizes');
    const pasteBtn = document.getElementById('pasteBtn');
    const dlFab = document.getElementById('dlFab');

    const VARIANTS = [
      {key:'maxresdefault', label:'Max (HD)', px:'1280×720'},
      {key:'sddefault',     label:'SD',       px:'640×480'},
      {key:'hqdefault',     label:'HQ',       px:'480×360'},
      {key:'mqdefault',     label:'MQ',       px:'320×180'},
      {key:'default',       label:'Default',  px:'120×90'}
    ];

    pasteBtn.addEventListener('click', async () => {
      try{
        const text = await navigator.clipboard.readText();
        if(text){ urlEl.value = text.trim(); handleUrl(); }
      }catch(e){
        alert('Clipboard permission blocked. Paste with Ctrl/⌘+V');
      }
    });

    urlEl.addEventListener('change', handleUrl);
    urlEl.addEventListener('paste', () => setTimeout(handleUrl, 0));
    urlEl.addEventListener('keyup', (e)=>{ if(e.key==='Enter') handleUrl(); });

    function resetAll(){
      urlEl.value=''; thumb.src=''; thumb.classList.add('hide'); dlFab.classList.add('hide'); ph.textContent='Thumbnail preview';
      sizes.innerHTML=''; setStatus('Paste a YouTube link.');
    }

    function setStatus(text, ok=false, err=false){
      statusEl.textContent=text; statusEl.classList.remove('ok','err');
      if(ok) statusEl.classList.add('ok'); if(err) statusEl.classList.add('err');
    }

    function extractId(u){
      try{
        const url = new URL(u);
        if(url.hostname.includes('youtu.be')) return url.pathname.slice(1);
        if(url.searchParams.get('v')) return url.searchParams.get('v');
        if(url.pathname.startsWith('/shorts/')) return url.pathname.split('/')[2];
        if(url.pathname.startsWith('/live/')) return url.pathname.split('/')[2];
      }catch{ /* fall back to regex */ }
      const m = (u||'').match(/(?:v=|\/shorts\/|youtu\.be\/|\/live\/)([\w-]{11})/);
      return m?m[1]:null;
    }

    async function checkImage(url){
      return new Promise(resolve=>{
        const img = new Image();
        img.onload = ()=> resolve(true);
        img.onerror = ()=> resolve(false);
        img.src = url + (url.includes('?')?'&':'?') + 't=' + Date.now();
      });
    }

    async function handleUrl(){
      const raw = urlEl.value.trim();
      const id = extractId(raw);
      if(!id){ setStatus('Invalid YouTube link.', false, true); thumb.classList.add('hide'); sizes.innerHTML=''; return; }

      setStatus('Fetching thumbnails…');
      const base = `https://img.youtube.com/vi/${id}`;
      const list = await Promise.all(VARIANTS.map(async v => {
        const url = `${base}/${v.key}.jpg`;
        const ok = await checkImage(url);
        return {...v, url, ok};
      }));

      const best = list.find(x=>x.ok) || null;
      if(best){
        thumb.src = best.url; thumb.alt = id; thumb.classList.remove('hide'); ph.textContent=''; dlFab.classList.remove('hide');
        setStatus('Ready. Click any size to download.', true, false);
      }else{
        thumb.classList.add('hide'); dlFab.classList.add('hide'); setStatus('No thumbnail found for this video.', false, true);
      }

      sizes.innerHTML = list.map(v => renderSize(v)).join('');
    }

    function renderSize(v){
      const icon = `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>`;
      const lock = `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>`;
      const left = `<div><div>${v.label}</div><small>${v.px}</small></div>`;
      if(v.ok){
        return `<div class="size"><a href="${v.url}" download target="_blank" rel="noopener" title="Download ${v.label}">${left}${icon}</a></div>`;
      } else {
        return `<div class="size"><a href="#" onclick="return false" aria-disabled="true" title="Unavailable">${left}${lock}</a></div>`;
      }
    }

    async function downloadBest(){
      const raw = urlEl.value.trim();
      const id = extractId(raw); if(!id) return;
      const base = `https://img.youtube.com/vi/${id}`;
      for(const k of ['maxresdefault','sddefault','hqdefault','mqdefault','default']){
        const u = `${base}/${k}.jpg`;
        const ok = await checkImage(u);
        if(ok){
          try{
            const a = document.createElement('a');
            a.href = u; a.download = `${id}-${k}.jpg`; a.target = '_blank'; a.rel = 'noopener';
            document.body.appendChild(a); a.click(); a.remove();
          }catch{ window.open(u, '_blank','noopener'); }
          return;
        }
      }
      alert('No downloadable thumbnail found.');
    }
  </script>
</body>
</html>
